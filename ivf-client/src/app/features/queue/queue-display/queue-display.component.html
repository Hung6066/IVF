<div class="queue-display">
    <header class="page-header">
        <h1 class="department-title">{{ getDepartmentName(departmentCode) }}</h1>
        <div class="header-actions">
            <div class="ticket-badge">
                <span class="ticket-icon">üé´</span>
                <span class="ticket-text">{{ tickets().length }} s·ªë ch·ªù</span>
            </div>
            <button class="btn btn-secondary btn-refresh" (click)="loadQueue()">
                <span class="refresh-icon">üîÑ</span>
                <span>L√†m m·ªõi</span>
            </button>
        </div>
    </header>

    <div class="queue-grid">
        <section class="queue-card current-section">
            <h2 class="section-title">ƒêang ph·ª•c v·ª•</h2>

            <div class="current-ticket-display" [class.active]="currentTicket()">
                @if (currentTicket()) {
                <span class="ticket-number">{{ currentTicket()!.ticketNumber }}</span>
                <span class="patient-name">{{ currentTicket()!.patientName || 'B·ªánh nh√¢n' }}</span>
                } @else {
                <span class="no-ticket-message">Ch∆∞a c√≥ l∆∞·ª£t g·ªçi</span>
                }
            </div>

            @if (currentTicket()) {
            <div class="action-buttons">
                <button class="btn btn-success" (click)="completeTicket()">
                    <span>‚úÖ Ho√†n th√†nh</span>
                </button>
                <button class="btn btn-secondary" (click)="skipTicket()">
                    <span>‚è≠Ô∏è B·ªè qua</span>
                </button>
            </div>
            }
        </section>

        <section class="queue-card waiting-section">
            <h2 class="section-title">H√†ng ch·ªù ti·∫øp theo</h2>

            <div class="waiting-list-container">
                @for (ticket of waitingTickets(); track ticket.id; let i = $index) {
                <div class="waiting-item" [class.next-up]="i === 0">
                    <div class="position-badge">{{ i + 1 }}</div>
                    <div class="ticket-info">
                        <span class="ticket-num">{{ ticket.ticketNumber }}</span>
                        <span class="ticket-time">{{ formatTime(ticket.issuedAt) }}</span>
                    </div>
                    @if (i === 0) {
                    <button class="btn btn-primary btn-call" (click)="callTicket(ticket.id)">
                        üì¢ G·ªçi
                    </button>
                    }
                </div>
                } @empty {
                <div class="empty-state">
                    <span class="empty-icon">üì≠</span>
                    <span>Kh√¥ng c√≥ b·ªánh nh√¢n ch·ªù</span>
                </div>
                }
            </div>
        </section>
    </div>
</div>