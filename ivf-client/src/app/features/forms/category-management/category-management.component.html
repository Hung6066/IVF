<div class="category-management">
    <header class="page-header">
        <div class="header-content">
            <h1>üìÅ Qu·∫£n l√Ω Danh m·ª•c</h1>
            <p>T·∫°o v√† qu·∫£n l√Ω danh m·ª•c bi·ªÉu m·∫´u</p>
        </div>
        <button class="btn btn-primary" (click)="openModal()">
            ‚ûï Th√™m danh m·ª•c
        </button>
    </header>

    <div class="categories-grid">
        @for (cat of categories; track cat.id) {
        <div class="category-card" [class.inactive]="!cat.isActive">
            <div class="card-header">
                <span class="icon">{{ cat.iconName || 'üìÅ' }}</span>
                <div class="card-actions">
                    <button class="btn-icon" (click)="edit(cat)" title="S·ª≠a">‚úèÔ∏è</button>
                    <button class="btn-icon danger" (click)="delete(cat)" title="X√≥a">üóëÔ∏è</button>
                </div>
            </div>
            <h3>{{ cat.name }}</h3>
            <p class="description">{{ cat.description || 'Kh√¥ng c√≥ m√¥ t·∫£' }}</p>
            <div class="card-footer">
                <span class="template-count">{{ cat.templateCount || 0 }} bi·ªÉu m·∫´u</span>
                <span class="status" [class.active]="cat.isActive">
                    {{ cat.isActive ? '‚úÖ Ho·∫°t ƒë·ªông' : '‚è∏Ô∏è T·∫°m d·ª´ng' }}
                </span>
            </div>
        </div>
        }

        @if (categories.length === 0) {
        <div class="empty-state">
            <span class="empty-icon">üìÇ</span>
            <h3>Ch∆∞a c√≥ danh m·ª•c n√†o</h3>
            <p>T·∫°o danh m·ª•c ƒë·∫ßu ti√™n ƒë·ªÉ t·ªï ch·ª©c bi·ªÉu m·∫´u</p>
            <button class="btn btn-primary" (click)="openModal()">T·∫°o danh m·ª•c</button>
        </div>
        }
    </div>

    <!-- Modal -->
    @if (showModal) {
    <div class="modal-overlay" (click)="closeModal()">
        <div class="modal" (click)="$event.stopPropagation()">
            <div class="modal-header">
                <h3>{{ editingCategory ? 'S·ª≠a danh m·ª•c' : 'Th√™m danh m·ª•c m·ªõi' }}</h3>
                <button class="close-btn" (click)="closeModal()">‚úï</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>T√™n danh m·ª•c *</label>
                    <input type="text" [(ngModel)]="formData.name" placeholder="VD: Ph√≤ng X√©t nghi·ªám">
                </div>
                <div class="form-group">
                    <label>M√¥ t·∫£</label>
                    <textarea [(ngModel)]="formData.description" placeholder="M√¥ t·∫£ danh m·ª•c..."></textarea>
                </div>
                <div class="form-group">
                    <label>Icon (emoji)</label>
                    <div class="icon-picker">
                        @for (icon of commonIcons; track icon) {
                        <button type="button" class="icon-option" [class.selected]="formData.iconName === icon"
                            (click)="formData.iconName = icon">
                            {{ icon }}
                        </button>
                        }
                    </div>
                </div>
                <div class="form-group">
                    <label>Th·ª© t·ª± hi·ªÉn th·ªã</label>
                    <input type="number" [(ngModel)]="formData.displayOrder" min="0">
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" (click)="closeModal()">H·ªßy</button>
                <button class="btn btn-primary" (click)="save()" [disabled]="!formData.name">
                    {{ editingCategory ? 'C·∫≠p nh·∫≠t' : 'T·∫°o m·ªõi' }}
                </button>
            </div>
        </div>
    </div>
    }
</div>