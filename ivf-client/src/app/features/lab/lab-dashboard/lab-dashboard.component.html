<div class="lab-dashboard page-container">
    <header class="page-header">
        <h1>üß´ Ph√≤ng Lab - LABO</h1>
        <div class="tabs-container">
            <button class="tab-btn" [class.active]="activeTab === 'queue'" (click)="setActiveTab('queue')">
                üé´ H√†ng ƒë·ª£i
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'embryos'" (click)="setActiveTab('embryos')">
                üî¨ Ph√¥i ƒëang nu√¥i
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'schedule'" (click)="setActiveTab('schedule')">
                üìÖ L·ªãch th·ªß thu·∫≠t
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'cryo'" (click)="setActiveTab('cryo')">
                ‚ùÑÔ∏è Kho ƒë√¥ng l·∫°nh
            </button>
            <button class="tab-btn" [class.active]="activeTab === 'report'" (click)="setActiveTab('report')">
                üìä B√°o c√°o ph√¥i
            </button>
        </div>
    </header>

    <div class="date-nav">
        <button (click)="changeDay(-1)">‚óÄ</button>
        <span class="current-date">{{ currentDate | date:'EEEE, dd/MM/yyyy' }}</span>
        <button (click)="changeDay(1)">‚ñ∂</button>
        <button class="btn-today" (click)="goToday()">H√¥m nay</button>
    </div>

    <div class="stats-row">
        <div class="stat-card">
            <span class="icon">ü•ö</span>
            <div>
                <span class="value">{{ stats().eggRetrievalCount }}</span>
                <span class="label">Ch·ªçc h√∫t</span>
            </div>
        </div>
        <div class="stat-card">
            <span class="icon">üî¨</span>
            <div>
                <span class="value">{{ stats().cultureCount }}</span>
                <span class="label">ƒêang nu√¥i</span>
            </div>
        </div>
        <div class="stat-card">
            <span class="icon">üíâ</span>
            <div>
                <span class="value">{{ stats().transferCount }}</span>
                <span class="label">Chuy·ªÉn ph√¥i</span>
            </div>
        </div>
        <div class="stat-card">
            <span class="icon">‚ùÑÔ∏è</span>
            <div>
                <span class="value">{{ stats().freezeCount }}</span>
                <span class="label">Tr·ªØ ph√¥i</span>
            </div>
        </div>
    </div>

    @if (activeTab === 'queue') {
    <app-lab-queue [queue]="queue()" (callPatient)="onCallPatient($event)" (startProcedure)="onStartProcedure($event)">
    </app-lab-queue>
    }

    @if (activeTab === 'embryos') {
    <app-lab-embryos [embryos]="embryos()" [currentDate]="currentDate" (selectEmbryo)="onSelectEmbryo($event)">
    </app-lab-embryos>
    }

    @if (activeTab === 'schedule') {
    <app-lab-schedule [schedule]="schedule()" [currentDate]="currentDate" (toggleStatus)="onToggleSchedule($event)">
    </app-lab-schedule>
    }

    @if (activeTab === 'cryo') {
    <app-lab-cryo [locations]="cryoLocations()" [stats]="stats()" (addLocation)="onAddCryoLocation($event)">
    </app-lab-cryo>
    }

    @if (activeTab === 'report') {
    <section class="content-section card">
        <div class="section-header">
            <h2>B√°o c√°o ph√¥i theo ng√†y</h2>
            <div class="report-actions">
                <button class="btn btn-secondary" (click)="exportExcel()">üìÑ Xu·∫•t Excel</button>
                <button class="btn btn-secondary" (click)="printReport()">üñ®Ô∏è In b√°o c√°o</button>
            </div>
        </div>
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>M√£ CK</th>
                        <th>B·ªánh nh√¢n</th>
                        <th>Ng√†y ch·ªçc</th>
                        <th>S·ªë tr·ª©ng</th>
                        <th>MII</th>
                        <th>2PN</th>
                        <th>D3</th>
                        <th>D5/D6</th>
                        <th>Chuy·ªÉn</th>
                        <th>Tr·ªØ</th>
                        <th>K·∫øt qu·∫£</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="code">CK-001</td>
                        <td>Nguy·ªÖn T.H</td>
                        <td>28/01</td>
                        <td>15</td>
                        <td>12</td>
                        <td>10</td>
                        <td>8</td>
                        <td>6 (4AA, 4BA, 3AB...)</td>
                        <td>2</td>
                        <td>4</td>
                        <td><span class="badge badge-success">Ho√†n th√†nh</span></td>
                    </tr>
                    <tr>
                        <td class="code">CK-002</td>
                        <td>Tr·∫ßn M.L</td>
                        <td>29/01</td>
                        <td>8</td>
                        <td>6</td>
                        <td>5</td>
                        <td>4</td>
                        <td>‚Äî</td>
                        <td>‚Äî</td>
                        <td>‚Äî</td>
                        <td><span class="badge badge-info">D3</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </section>
    }
</div>